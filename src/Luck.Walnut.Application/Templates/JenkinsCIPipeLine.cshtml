@using Luck.Walnut.Domain.AggregateRoots.ApplicationPipelines
@{

    PipelineMetaData metadata = Model;
}

pipeline {
    agent {
        kubernetes {
            defaultContainer 'jnlp'
            yaml """
apiVersion: v1
kind: Pod
metadata:
namespace: luck-infrastructure
spec:
  containers:
  @{
    foreach (var container in metadata.Containers)
    {
        <text>
            -name: @container.ContainerName
        </text>
        <text>
            image: @container.ImageName
        </text>
        <text>
            workingDir: @container.WorkingDir
        </text>
        <text>
            command:@foreach (var command in container.CommandArr)
            {
                <text>
                    - @command
                </text>
            }
        </text>
        <text>
            args:@foreach (var command in container.CommandArr)
            {
                <text>
                  - @command
                 </text>
            }
        </text>
        <text>
            tty: true
        </text>
    }

    }




        
        }
    }
}
